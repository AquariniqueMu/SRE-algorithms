# SRE工程师学习笔记



SRE: Site Reliability Engineering

SLA: Service-level Agreement 

## 一、SRE工作内容

### 1、容量规划与实施

​		SRE工作的两个基本问题：

1. 要支持每秒X个请求的流量，需要多少台机器？
2. 给Y台机器，如何部署服务栈Serving Stack使其服务容量capacity最大，即每秒支持请求数最多？

​		Serving Stack由很多服务程序server组成，每个server有各自的资源需求（进程占用内存和CPU），每个server有多个replica，算出各server的replica的数目，使计算资源得到充分利用。根据server性能的变化，及时调整replica的数目，实现配平。

### 2、部署新的服务集群serving cluster

​		上线新的数据中心data center时，serving stack也要跟着迁移，容量规划工具应适应多种硬件类型（不同的CPU数目和内存大小）。

### 3、冗余与容错		

​		容量规划要做到允许两个数据中心同时下线。例如一个数据中心在例行维护，另一个突发影响必须下线，要保证系统仍提供正常服务。

### 4、负载均衡

​		

### 5、上线新服务on-boarding service



### 6、监控Monitoring

​		编写合适的监控与报警规则，快速找到故障根源。以下是基本的监控指标：

1. 流量traffic，如queries per second
2. 延迟latency
3. 错误率error ratio
4. 资源使用率utilization

### 6、值班on-call



### 7、救火Firefighting



## SRE工作职责

根据Google团队定义，SRE主要职责包括：可用性改进、延迟优化、性能优化、效率优化、变更管理、监控、紧急事务处理、容量规划与管理。

### SRE核心方法论

#### 1、长期关注研发工作

#### 2、保障服务slo的前提下最大化迭代速度

#### 3、监控系统

​		监控系统的三类输出：

1. 紧急警报alert
2. 工单ticket
3. 日志logging

#### 4、应急事件处理

​		可靠性是MTTF（平均失败时间）和MTTR（平均恢复时间）的函数，评估恢复能力的最有效指标就是MTTR

#### 5、变更管理

​		使用自动化完成以下项目：

1. 采用渐进式发布机制
2. 迅速而准确地检测问题的发生
3. 出现问题时，安全迅速地回退改动

#### 6、需求预测和容量规划

​		保障一个业务有足够的容量和冗余度去服务预测中的未来需求。

​		容量规划的必要步骤包括：

1. 有一个准确的自然增长需求预测模型，需求预测的时间应该超过资源获取的时间
2. 规划中必须有准确的非自然增长的需求来源的统计
3. 必须有周期性压力测试，以便准确对应系统原始资源信息和业务容量

​		SRE应该主导容量规划的过程，也即主导资源部署的过程。

#### 7、资源部署

​		资源部署provisinging，变更管理与容量规划的结合。

#### 8、效率与性能

​		高效利用计算资源。



















